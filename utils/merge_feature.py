from feature.rated_window_entropy_map import *


ROOT_DIR_PATH = r'C:\Users\BAEK\Desktop\research\Malware_android\dataset\entropy_histogram_l2'
ADWARE_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'ADWARE')
BENIGN_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'BENIGN')
DOWNLOADER_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'DOWNLOADER')
HIDER_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'HIDER')
PACKED_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'PACKED')
REMOTECON_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'REMOTECON')
REPLICATOR_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'REPLICATOR')
TROJAN_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'TROJWARE')
WARN_DIR_PATH = os.path.join(ROOT_DIR_PATH, 'WARN')

MODE = 'binary'
FEATURE_FILE_PATH = r'C:\Users\BAEK\Desktop\research\Malware_android\feature\binary_12000_l2.spa'
NUMBER_OF_FEATURES_PER_CLASS = 12000


if __name__ == '__main__':
    dir_paths = list()
    dir_paths.append(ADWARE_DIR_PATH)
    dir_paths.append(BENIGN_DIR_PATH)
    dir_paths.append(DOWNLOADER_DIR_PATH)
    dir_paths.append(HIDER_DIR_PATH)
    dir_paths.append(PACKED_DIR_PATH)
    dir_paths.append(REMOTECON_DIR_PATH)
    dir_paths.append(REPLICATOR_DIR_PATH)
    dir_paths.append(TROJAN_DIR_PATH)
    dir_paths.append(WARN_DIR_PATH)

    features = list()

    cls = 0
    for dir_path in dir_paths:
        file_paths = glob.glob(os.path.join(dir_path, '*'))

        count = 0
        for file_path in file_paths:
            with open(file_path, 'r') as file_descriptor:
                lines = file_descriptor.readlines()

            if count >= NUMBER_OF_FEATURES_PER_CLASS:
                continue

            for line in lines:
                features.append('{0} {1}'.format(cls, line))

            count += 1

        if MODE == 'binary':
            cls = 1

            continue

        cls += 1

    with open(FEATURE_FILE_PATH, 'w') as file_descriptor:
        for feature in features:
            file_descriptor.write(feature)
            file_descriptor.write('\n')
